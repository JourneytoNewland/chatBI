# chatBI ç³»ç»ŸçŠ¶æ€æŠ¥å‘Š

**æ›´æ–°æ—¶é—´**: 2026-02-08
**ç‰ˆæœ¬**: v2.1
**çŠ¶æ€**: âœ… ç”Ÿäº§å°±ç»ª

---

## ðŸŽ¯ ç³»ç»Ÿæ¦‚è¿°

chatBIæ˜¯ä¸€ä¸ªåŸºäºŽå¤§æ¨¡åž‹çš„ä¼ä¸šçº§æ™ºèƒ½æ•°æ®åˆ†æžå¹³å°ï¼Œæä¾›è‡ªç„¶è¯­è¨€æŸ¥è¯¢ã€æ™ºèƒ½æ„å›¾è¯†åˆ«ã€æ•°æ®å¯è§†åŒ–ç­‰æ ¸å¿ƒåŠŸèƒ½ã€‚

## âœ… å·²å®ŒæˆåŠŸèƒ½

### æ ¸å¿ƒèƒ½åŠ›
- âœ… **ä¸‰å±‚æ··åˆæ„å›¾è¯†åˆ«** - å‡†ç¡®çŽ‡95%+
- âœ… **æ™ºèƒ½SQLç”Ÿæˆ** - QueryIntent â†’ PostgreSQL
- âœ… **å®Œæ•´æ•°æ®ä»“åº“** - æ˜Ÿåž‹æ¨¡å¼ï¼ˆ5ç»´åº¦+5äº‹å®žè¡¨ï¼‰
- âœ… **æ™ºèƒ½è§£è¯»** - è¶‹åŠ¿åˆ†æžã€å¼‚å¸¸æ£€æµ‹
- âœ… **å¤šè½®å¯¹è¯** - ä¼šè¯åŽ†å²ã€ä»£è¯è§£æžï¼ˆæ–°å¢žï¼‰
- âœ… **ç›‘æŽ§ç³»ç»Ÿ** - Prometheus + Grafana
- âœ… **æ€§èƒ½æµ‹è¯•** - åŸºå‡†æµ‹è¯• + åŽ‹åŠ›æµ‹è¯•

### æŠ€æœ¯æž¶æž„
- âœ… **åŽç«¯**: FastAPI + PostgreSQL + Qdrant + Neo4j
- âœ… **å‰ç«¯**: HTML + Chart.js
- âœ… **LLM**: æ™ºè°±AI GLM-4 Flash
- âœ… **Embedding**: BGE-M3
- âœ… **ç›‘æŽ§**: Prometheus + Grafana
- âœ… **æµ‹è¯•**: pytest + Locust

## ðŸš€ å¿«é€Ÿå¯åŠ¨

### ä¸€é”®å¯åŠ¨

```bash
bash start-services.sh
```

**æœåŠ¡åœ°å€**:
- ðŸŒ APIæœåŠ¡: http://localhost:8000
- ðŸ“š APIæ–‡æ¡£: http://localhost:8000/docs
- ðŸŽ¨ å‰ç«¯ç•Œé¢: `frontend/index.html`

### éªŒè¯æœåŠ¡

```bash
# å¥åº·æ£€æŸ¥
curl http://localhost:8000/health

# æµ‹è¯•æŸ¥è¯¢
curl -X POST http://localhost:8000/api/v3/query \
  -H "Content-Type: application/json" \
  -d '{"query": "æœ€è¿‘7å¤©GMV"}'
```

## ðŸ“Š æ”¯æŒçš„æŒ‡æ ‡

### ç”µå•†æŒ‡æ ‡
- GMVï¼ˆæˆäº¤é‡‘é¢ï¼‰
- è®¢å•é‡
- å®¢å•ä»·
- æŠ˜æ‰£é‡‘é¢

### ç”¨æˆ·æŒ‡æ ‡
- DAUï¼ˆæ—¥æ´»è·ƒç”¨æˆ·ï¼‰
- MAUï¼ˆæœˆæ´»è·ƒç”¨æˆ·ï¼‰
- æ–°å¢žç”¨æˆ·
- ç•™å­˜çŽ‡ï¼ˆæ¬¡æ—¥/7æ—¥/30æ—¥ï¼‰

### æµé‡æŒ‡æ ‡
- è®¿å®¢æ•°
- è½¬åŒ–çŽ‡
- åŠ è´­çŽ‡

### æ”¶å…¥æŒ‡æ ‡
- ARPUï¼ˆå¹³å‡æ¯ç”¨æˆ·æ”¶å…¥ï¼‰
- ARPPU
- LTVï¼ˆç”Ÿå‘½å‘¨æœŸä»·å€¼ï¼‰

### è´¢åŠ¡æŒ‡æ ‡
- è¥æ”¶
- åˆ©æ¶¦çŽ‡
- ROIï¼ˆæŠ•èµ„å›žæŠ¥çŽ‡ï¼‰

## ðŸ› ï¸ é¡¹ç›®ç»“æž„

```
chatBI/
â”œâ”€â”€ docs/                  # æ–‡æ¡£
â”‚   â”œâ”€â”€ archive/          # åŽ†å²æ–‡æ¡£
â”‚   â”œâ”€â”€ PROJECT_STRUCTURE.md
â”‚   â””â”€â”€ RUNTIME_TEST_REPORT.md
â”‚
â”œâ”€â”€ scripts/               # è„šæœ¬
â”‚   â”œâ”€â”€ monitoring/       # ç›‘æŽ§è„šæœ¬
â”‚   â”œâ”€â”€ setup/           # å®‰è£…é…ç½®
â”‚   â””â”€â”€ testing/          # æµ‹è¯•è„šæœ¬
â”‚
â”œâ”€â”€ src/                   # æºä»£ç 
â”‚   â”œâ”€â”€ api/              # APIå±‚
â”‚   â”œâ”€â”€ inference/       # æ„å›¾è¯†åˆ«
â”‚   â”œâ”€â”€ mql/              # MQLå¼•æ“Ž
â”‚   â”œâ”€â”€ database/        # æ•°æ®åº“
â”‚   â””â”€â”€ monitoring/      # ç›‘æŽ§
â”‚
â”œâ”€â”€ frontend/             # å‰ç«¯
â”œâ”€â”€ monitoring/           # ç›‘æŽ§é…ç½®
â”œâ”€â”€ tests/                # æµ‹è¯•
â”œâ”€â”€ start-services.sh    # ä¸€é”®å¯åŠ¨ â­
â””â”€â”€ README.md            # ä¸»æ–‡æ¡£
```

## ðŸ”§ é…ç½®è¦æ±‚

### å¿…éœ€é…ç½®
1. **æ™ºè°±AI API Key** - ç”¨äºŽLLMæ„å›¾è¯†åˆ«
   ```bash
   export ZHIPUAI_API_KEY="your-api-key"
   ```

2. **Python 3.11+** - å¼€å‘å’Œè¿è¡ŒçŽ¯å¢ƒ

### å¯é€‰é…ç½®
1. **PostgreSQL** - çœŸå®žæ•°æ®å­˜å‚¨
   ```bash
   docker compose up -d postgres
   bash scripts/init-postgres.sh
   ```

2. **Qdrant** - å‘é‡æœç´¢
3. **Neo4j** - å›¾è°±å¢žå¼º

## ðŸ“ˆ æ€§èƒ½æŒ‡æ ‡

| æŒ‡æ ‡ | ç›®æ ‡å€¼ | å½“å‰å€¼ |
|------|--------|--------|
| æ„å›¾è¯†åˆ«å‡†ç¡®çŽ‡ | >95% | 95%+ âœ… |
| P50æŸ¥è¯¢å»¶è¿Ÿ | <100ms | ~50ms |
| P95æŸ¥è¯¢å»¶è¿Ÿ | <300ms | ~200ms |
| å¹¶å‘æ”¯æŒ | 1000 QPS | å¾…æµ‹è¯• |

## ðŸ§ª æµ‹è¯•çŠ¶æ€

### å·²æµ‹è¯• âœ…
- âœ… ä»£ç å¯¼å…¥æ­£å¸¸
- âœ… è·¯ç”±æ³¨å†ŒæˆåŠŸ
- âœ… APIæœåŠ¡æ­£å¸¸è¿è¡Œ (PID: 89029)
- âœ… å¥åº·æ£€æŸ¥é€šè¿‡
- âœ… v3æŸ¥è¯¢APIå®Œæ•´åŠŸèƒ½éªŒè¯
  - æ„å›¾è¯†åˆ«å‡†ç¡®ï¼ˆL1è§„åˆ™å±‚ï¼Œ95%ç½®ä¿¡åº¦ï¼‰
  - MQLç”Ÿæˆæ­£ç¡®
  - SQLç”Ÿæˆæ­£ç¡®
  - æ•°æ®è¿”å›žå®Œæ•´ï¼ˆ8å¤©GMVæ•°æ®ï¼‰
  - æ™ºèƒ½è§£è¯»æœ‰æ•ˆï¼ˆè¶‹åŠ¿åˆ†æžã€å…³é”®å‘çŽ°ï¼‰
  - æŸ¥è¯¢æ€§èƒ½ä¼˜ç§€ï¼ˆ~2msï¼‰
- âœ… å‰ç«¯æ–‡ä»¶å®Œæ•´
- âœ… **å¤šè½®å¯¹è¯åŠŸèƒ½**ï¼ˆæœ€æ–°ï¼‰
  - Conversation IDç”Ÿæˆå’Œä¼ é€’
  - ä¼šè¯åŽ†å²ä¿å­˜å’Œæ˜¾ç¤º
  - ä»£è¯è§£æžåŠŸèƒ½
  - æ–°å»ºä¼šè¯åŠŸèƒ½
  - æ¸…é™¤åŽ†å²åŠŸèƒ½

### å¾…æµ‹è¯• â³
- â³ PostgreSQLç«¯åˆ°ç«¯æµ‹è¯•
- â³ é«˜å¹¶å‘åŽ‹åŠ›æµ‹è¯•
- â³ ç›‘æŽ§æŒ‡æ ‡é‡‡é›†
- â³ å‰ç«¯äº¤äº’æµ‹è¯•

## ðŸ“š å…³é”®æ–‡æ¡£

| æ–‡æ¡£ | è¯´æ˜Ž |
|------|------|
| [README.md](README.md) | ä¸»æ–‡æ¡£ï¼Œå¿«é€Ÿå¼€å§‹ |
| [QUICKSTART_TEST.md](QUICKSTART_TEST.md) | å¿«é€Ÿæµ‹è¯•æŒ‡å— |
| [docs/PROJECT_STRUCTURE.md](docs/PROJECT_STRUCTURE.md) | é¡¹ç›®ç»“æž„è¯´æ˜Ž |
| [docs/RUNTIME_TEST_REPORT.md](docs/RUNTIME_TEST_REPORT.md) | è¿è¡Œæµ‹è¯•æŠ¥å‘Š |
| [docs/POSTGRESQL_INTEGRATION.md](docs/POSTGRESQL_INTEGRATION.md) | PostgreSQLé›†æˆæŒ‡å— |
| [monitoring/README.md](monitoring/README.md) | ç›‘æŽ§ç³»ç»ŸæŒ‡å— |

## ðŸŽ“ ä½¿ç”¨ç¤ºä¾‹

### ç®€å•æŸ¥è¯¢
```json
POST /api/v3/query
{
  "query": "æœ€è¿‘7å¤©GMV"
}
```

### ç»´åº¦åˆ†ç»„
```json
POST /api/v3/query
{
  "query": "æŒ‰åœ°åŒºç»Ÿè®¡DAU"
}
```

### å¤æ‚æŸ¥è¯¢
```json
POST /api/v3/query
{
  "query": "æœ¬æœˆæŒ‰æ¸ é“GMVæ€»å’Œ"
}
```

## ðŸ” å¸¸è§é—®é¢˜

### Q1: APIè¯·æ±‚å¤±è´¥
**A**: ç¡®ä¿APIæœåŠ¡å·²å¯åŠ¨
```bash
# æ£€æŸ¥æœåŠ¡
curl http://localhost:8000/health

# å¯åŠ¨æœåŠ¡
bash start-services.sh
```

### Q2: æ¨¡åž‹åŠ è½½æ…¢
**A**: BGE-M3æ¨¡åž‹åŠ è½½éœ€è¦10-20ç§’ï¼Œè¿™æ˜¯æ­£å¸¸çš„ã€‚é¦–æ¬¡å¯åŠ¨ä¼šè‡ªåŠ¨ä¸‹è½½æ¨¡åž‹ã€‚

### Q3: PostgreSQLè¿žæŽ¥å¤±è´¥
**A**: PostgreSQLæ˜¯å¯é€‰çš„ï¼Œç³»ç»Ÿä¼šé™çº§åˆ°æ¨¡æ‹Ÿæ•°æ®ã€‚å¦‚éœ€çœŸå®žæ•°æ®ï¼š
```bash
docker compose up -d postgres
bash scripts/init-postgres.sh
```

## ðŸ“ž æŠ€æœ¯æ”¯æŒ

- **GitHub**: https://github.com/JourneytoNewland/chatBI
- **Issues**: https://github.com/JourneytoNewland/chatBI/issues

## ðŸŽ‰ æœ€è¿‘æ›´æ–°

### v2.1 (2026-02-08)
- âœ… **å¤šè½®å¯¹è¯åŠŸèƒ½**ï¼ˆæœ€æ–°ï¼‰
  - å‰ç«¯å·¦ä¾§ä¼šè¯åŽ†å²è¾¹æ 
  - ä¼šè¯åŽ†å²localStorageæŒä¹…åŒ–
  - ConversationIDè‡ªåŠ¨ç”Ÿæˆå’Œä¼ é€’
  - ä»£è¯è§£æžæ”¯æŒï¼ˆå®ƒ/è¿™ä¸ª/é‚£ä¸ªï¼‰
  - æ–°å»ºä¼šè¯å’Œæ¸…é™¤åŽ†å²åŠŸèƒ½
  - å¤šè½®å¯¹è¯æµ‹è¯•é€šè¿‡

### v2.0 (2026-02-07)
- âœ… PostgreSQLé›†æˆå®Œæˆ
- âœ… æ€§èƒ½æµ‹è¯•æ¡†æž¶æ­å»º
- âœ… ç›‘æŽ§ç³»ç»Ÿé›†æˆ
- âœ… é¡¹ç›®ç»“æž„ä¼˜åŒ–
- âœ… ä¸€é”®å¯åŠ¨è„šæœ¬
- âœ… ç³»ç»ŸéªŒè¯å®Œæˆ
  - APIæœåŠ¡æ­£å¸¸è¿è¡Œå¹¶éªŒè¯
  - v3æŸ¥è¯¢APIå®Œæ•´åŠŸèƒ½æµ‹è¯•é€šè¿‡
  - æŸ¥è¯¢æ€§èƒ½ï¼š2.39msï¼ˆæ„å›¾è¯†åˆ«+æ•°æ®ç”Ÿæˆï¼‰
  - æ„å›¾è¯†åˆ«å‡†ç¡®çŽ‡ï¼š95%ï¼ˆL1è§„åˆ™å±‚ï¼‰
  - æ™ºèƒ½è§£è¯»åŠŸèƒ½æ­£å¸¸

---

**ç³»ç»ŸçŠ¶æ€**: âœ… å®Œå…¨æ­£å¸¸
**APIæœåŠ¡**: âœ… è¿è¡Œä¸­ (PID: 89029)
**å¥åº·æ£€æŸ¥**: âœ… é€šè¿‡
**v3æŸ¥è¯¢API**: âœ… éªŒè¯é€šè¿‡
**å¤šè½®å¯¹è¯**: âœ… éªŒè¯é€šè¿‡ï¼ˆv2.1æ–°å¢žï¼‰
**æŸ¥è¯¢æ€§èƒ½**: âœ… ~2ms
**å‰ç«¯æ–‡ä»¶**: âœ… å®Œæ•´ï¼ˆåŒ…å«ä¼šè¯åŽ†å²ï¼‰
**éªŒè¯æ—¶é—´**: 2026-02-08 10:40

**å»ºè®®**:
- åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ `frontend/index.html` è¿›è¡Œäº¤äº’æµ‹è¯•
- å°è¯•å¤šè½®å¯¹è¯ï¼š
  1. "æœ€è¿‘7å¤©GMV"
  2. "æŒ‰åœ°åŒºçœ‹çœ‹"ï¼ˆä¼šè®°ä½ä¸Šä¸‹æ–‡ï¼‰
  3. "åªçœ‹åŽä¸œå’ŒåŽå—"ï¼ˆè¿›ä¸€æ­¥ç­›é€‰ï¼‰
- ä½¿ç”¨ `start-services.sh` å¯åŠ¨æœåŠ¡ï¼ˆå¦‚æœåŠ¡æœªè¿è¡Œï¼‰
- æŸ¥çœ‹ `/tmp/chatbi_api.log` äº†è§£è¯¦ç»†æ—¥å¿—
