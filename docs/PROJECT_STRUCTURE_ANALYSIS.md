# chatBI é¡¹ç›®ç»“æ„åˆ†æ

## ğŸ“Š å½“å‰ç›®å½•ç»“æ„è¯„ä¼°

### âœ… ä¼˜ç‚¹
1. **æ¸…æ™°çš„æ¨¡å—åŒ–**: src/ç›®å½•æŒ‰åŠŸèƒ½æ¨¡å—åˆ’åˆ†
2. **å®Œå–„çš„æµ‹è¯•ä½“ç³»**: tests/ç›®å½•åŒ…å«å•å…ƒæµ‹è¯•ã€é›†æˆæµ‹è¯•ã€æ€§èƒ½æµ‹è¯•
3. **è§„èŒƒçš„æ–‡æ¡£ç®¡ç†**: docs/ç›®å½•ç»“æ„æ¸…æ™°ï¼Œarchive/å½’æ¡£å†å²æ–‡æ¡£
4. **ç‹¬ç«‹çš„å‰ç«¯**: frontend/ç›®å½•åŒ…å«æ‰€æœ‰å‰ç«¯èµ„æº
5. **é…ç½®ç®¡ç†**: æ ¹ç›®å½•åªä¿ç•™å¿…è¦çš„é…ç½®æ–‡ä»¶

### ğŸ”§ å»ºè®®ä¼˜åŒ–
1. âœ… **å·²å®Œæˆ**: ç§»åŠ¨testæ–‡ä»¶åˆ°tests/ç›®å½•
2. âœ… **å·²å®Œæˆ**: ç§»åŠ¨run-production-server.pyåˆ°scripts/
3. âš ï¸ **å¯é€‰**: æ•´ç†frontend/ä¸­çš„æµ‹è¯•é¡µé¢

---

## ğŸ“ å®Œæ•´é¡¹ç›®ç»“æ„

```
chatBI/
â”œâ”€â”€ ğŸ“„ é…ç½®æ–‡ä»¶ï¼ˆæ ¹ç›®å½•ï¼‰
â”‚   â”œâ”€â”€ README.md                    # é¡¹ç›®ä¸»æ–‡æ¡£
â”‚   â”œâ”€â”€ CLAUDE.md                    # é¡¹ç›®å¼€å‘æŒ‡å—
â”‚   â”œâ”€â”€ .gitignore                   # Gitå¿½ç•¥é…ç½®
â”‚   â”œâ”€â”€ .env.example                 # ç¯å¢ƒå˜é‡æ¨¡æ¿
â”‚   â”œâ”€â”€ requirements.txt             # Pythonä¾èµ–
â”‚   â”œâ”€â”€ docker-compose.yml           # Dockerç¼–æ’
â”‚   â””â”€â”€ .pre-commit-config.yaml      # Pre-commité’©å­
â”‚
â”œâ”€â”€ ğŸ æºä»£ç 
â”‚   â”œâ”€â”€ src/                         # æ ¸å¿ƒä»£ç 
â”‚   â”‚   â”œâ”€â”€ api/                     # APIå±‚ï¼ˆFastAPIï¼‰
â”‚   â”‚   â”‚   â”œâ”€â”€ main.py              # FastAPIä¸»åº”ç”¨
â”‚   â”‚   â”‚   â”œâ”€â”€ complete_query.py    # å®Œæ•´æŸ¥è¯¢APIï¼ˆL1-L4é›†æˆï¼‰
â”‚   â”‚   â”‚   â”œâ”€â”€ models.py            # Pydanticæ•°æ®æ¨¡å‹
â”‚   â”‚   â”‚   â””â”€â”€ v2_query_api.py      # API v2ç‰ˆæœ¬
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ inference/               # æ¨ç†å¼•æ“
â”‚   â”‚   â”‚   â”œâ”€â”€ intent.py            # æ„å›¾å®šä¹‰ä¸è¯†åˆ«å™¨
â”‚   â”‚   â”‚   â”œâ”€â”€ enhanced_hybrid.py   # ä¸‰å±‚æ··åˆæ„å›¾è¯†åˆ«
â”‚   â”‚   â”‚   â”œâ”€â”€ llm_intent.py        # LLMæ„å›¾è¯†åˆ«
â”‚   â”‚   â”‚   â”œâ”€â”€ zhipu_intent.py      # æ™ºè°±AIæ„å›¾è¯†åˆ«
â”‚   â”‚   â”‚   â”œâ”€â”€ root_cause/          # æ ¹å› åˆ†ææ¨¡å—ï¼ˆNEW!ï¼‰
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ analyzer.py      # åˆ†æå™¨å®ç°
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ root_cause_analyzer.py  # ä¸»å…¥å£
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ recall/                  # å¬å›å±‚
â”‚   â”‚   â”‚   â”œâ”€â”€ vector/              # å‘é‡å¬å›
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ qdrant_store.py  # Qdrantå­˜å‚¨
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ vectorizer.py    # å‘é‡åŒ–å™¨
â”‚   â”‚   â”‚   â””â”€â”€ graph/               # å›¾è°±å¬å›
â”‚   â”‚   â”‚       â”œâ”€â”€ neo4j_client.py  # Neo4jå®¢æˆ·ç«¯
â”‚   â”‚   â”‚       â””â”€â”€ graph_store.py   # å›¾è°±å­˜å‚¨
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ rerank/                  # ç²¾æ’å±‚
â”‚   â”‚   â”‚   â”œâ”€â”€ ranker.py            # æ’åºå™¨
â”‚   â”‚   â”‚   â””â”€â”€ fusion_ranker.py     # èåˆæ’åº
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ mql/                     # MQLå¼•æ“
â”‚   â”‚   â”‚   â”œâ”€â”€ engine_v2.py         # MQLæ‰§è¡Œå¼•æ“V2
â”‚   â”‚   â”‚   â”œâ”€â”€ sql_generator_v2.py  # SQLç”Ÿæˆå™¨V2
â”‚   â”‚   â”‚   â”œâ”€â”€ intelligent_interpreter.py  # æ™ºèƒ½è§£è¯»
â”‚   â”‚   â”‚   â””â”€â”€ models.py            # MQLæ•°æ®æ¨¡å‹
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ database/                # æ•°æ®åº“
â”‚   â”‚   â”‚   â”œâ”€â”€ postgres_client.py   # PostgreSQLå®¢æˆ·ç«¯
â”‚   â”‚   â”‚   â”œâ”€â”€ migrations/          # æ•°æ®åº“è¿ç§»
â”‚   â”‚   â”‚   â””â”€â”€ init_test_data.py    # æµ‹è¯•æ•°æ®
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ embedding/               # åµŒå…¥æ¨¡å‹
â”‚   â”‚   â”‚   â””â”€â”€ bge_embedding.py      # BGEåµŒå…¥
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ validator/               # éªŒè¯å™¨
â”‚   â”‚   â”‚   â””â”€â”€ query_validator.py    # æŸ¥è¯¢éªŒè¯
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ config.py                # é…ç½®ç®¡ç†
â”‚   â”‚   â””â”€â”€ __init__.py
â”‚   â”‚
â”œâ”€â”€ ğŸ§ª æµ‹è¯•
â”‚   â”œâ”€â”€ tests/                       # æµ‹è¯•ç›®å½•
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ conftest.py               # Pytesté…ç½®
â”‚   â”‚   â”œâ”€â”€ test_inference/           # æ¨ç†æµ‹è¯•
â”‚   â”‚   â”‚   â”œâ”€â”€ test_root_cause.py           # æ ¹å› åˆ†ææµ‹è¯•
â”‚   â”‚   â”‚   â””â”€â”€ test_intent_integration.py   # æ„å›¾é›†æˆæµ‹è¯•
â”‚   â”‚   â”œâ”€â”€ test_integration/         # é›†æˆæµ‹è¯•
â”‚   â”‚   â”‚   â””â”€â”€ test_full_query_flow.py      # å®Œæ•´æµç¨‹æµ‹è¯•
â”‚   â”‚   â”œâ”€â”€ test_api/                 # APIæµ‹è¯•
â”‚   â”‚   â”œâ”€â”€ test_mql/                 # MQLæµ‹è¯•
â”‚   â”‚   â”œâ”€â”€ test_recall/              # å¬å›æµ‹è¯•
â”‚   â”‚   â”œâ”€â”€ test_rerank/              # ç²¾æ’æµ‹è¯•
â”‚   â”‚   â”œâ”€â”€ test_services/            # æœåŠ¡æµ‹è¯•
â”‚   â”‚   â”œâ”€â”€ test_validator/           # éªŒè¯æµ‹è¯•
â”‚   â”‚   â””â”€â”€ performance/              # æ€§èƒ½æµ‹è¯•
â”‚   â”‚       â”œâ”€â”€ README.md
â”‚   â”‚       â”œâ”€â”€ load_test.py         # Locustå‹åŠ›æµ‹è¯•
â”‚   â”‚       â””â”€â”€ benchmark.py         # åŸºå‡†æµ‹è¯•
â”‚   â”‚
â”œâ”€â”€ ğŸ“± å‰ç«¯
â”‚   â”œâ”€â”€ frontend/                    # å‰ç«¯èµ„æº
â”‚   â”‚   â”œâ”€â”€ index.html               # ä¸»ç•Œé¢
â”‚   â”‚   â”œâ”€â”€ intent-visualization-v2.html  # æ„å›¾å¯è§†åŒ–
â”‚   â”‚   â”œâ”€â”€ pipeline-*.html          # æµç¨‹å¯è§†åŒ–
â”‚   â”‚   â”œâ”€â”€ graph-management*.html   # å›¾è°±ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ dashboard.html           # ä»ªè¡¨æ¿
â”‚   â”‚   â”œâ”€â”€ diagnose.html            # è¯Šæ–­é¡µé¢
â”‚   â”‚   â”œâ”€â”€ test_root_cause_frontend.html  # æ ¹å› åˆ†ææ¼”ç¤º
â”‚   â”‚   â”œâ”€â”€ README.md
â”‚   â”‚   â””â”€â”€ README_ACCESS.md
â”‚   â”‚
â”œâ”€â”€ ğŸ“š æ–‡æ¡£
â”‚   â”œâ”€â”€ docs/                        # æ–‡æ¡£ç›®å½•
â”‚   â”‚   â”œâ”€â”€ README.md                # æ–‡æ¡£ç´¢å¼•
â”‚   â”‚   â”œâ”€â”€ ROOT_CAUSE_USAGE.md      # æ ¹å› åˆ†æä½¿ç”¨æŒ‡å—ï¼ˆNEW!ï¼‰
â”‚   â”‚   â”œâ”€â”€ SECURITY_CHECK_SUMMARY.md  # å®‰å…¨æ£€æŸ¥æŠ¥å‘Šï¼ˆNEW!ï¼‰
â”‚   â”‚   â”œâ”€â”€ root_cause_analysis_summary.md  # æ ¹å› åˆ†ææ€»ç»“
â”‚   â”‚   â”œâ”€â”€ POSTGRESQL_INTEGRATION.md # PostgreSQLé›†æˆ
â”‚   â”‚   â”œâ”€â”€ INTENT_RECOGNITION_ARCHITECTURE.md  # æ„å›¾è¯†åˆ«æ¶æ„
â”‚   â”‚   â”œâ”€â”€ MQL_SYSTEM_SUMMARY.md    # MQLç³»ç»Ÿæ–‡æ¡£
â”‚   â”‚   â”œâ”€â”€ SECURITY_BEST_PRACTICES.md  # å®‰å…¨æœ€ä½³å®è·µ
â”‚   â”‚   â”œâ”€â”€ ARCHITECTURE.md           # ç³»ç»Ÿæ¶æ„
â”‚   â”‚   â”œâ”€â”€ PROJECT_STRUCTURE.md      # é¡¹ç›®ç»“æ„
â”‚   â”‚   â””â”€â”€ archive/                 # å†å²æ–‡æ¡£å½’æ¡£
â”‚   â”‚       â”œâ”€â”€ ã€æ–¹æ¡ˆä¸‰ã€‘...
â”‚   â”‚       â”œâ”€â”€ ã€æ–¹æ¡ˆä¸‰éš¾ç‚¹è§£æã€‘...
â”‚   â”‚       â””â”€â”€ ...
â”‚   â”‚
â”œâ”€â”€ ğŸ”§ è„šæœ¬
â”‚   â”œâ”€â”€ scripts/                     # è„šæœ¬ç›®å½•
â”‚   â”‚   â”œâ”€â”€ setup/                   # å®‰è£…é…ç½®
â”‚   â”‚   â”œâ”€â”€ run_demo_server.py       # æ¼”ç¤ºæœåŠ¡å™¨
â”‚   â”‚   â”œâ”€â”€ run_dev_server.py        # å¼€å‘æœåŠ¡å™¨
â”‚   â”‚   â”œâ”€â”€ run-production-server.py # ç”Ÿäº§æœåŠ¡å™¨
â”‚   â”‚   â”œâ”€â”€ init_seed_data.py        # åˆå§‹åŒ–ç§å­æ•°æ®
â”‚   â”‚   â”œâ”€â”€ init_graph.py            # åˆå§‹åŒ–å›¾è°±
â”‚   â”‚   â”œâ”€â”€ quick_init_qdrant.py     # å¿«é€Ÿåˆå§‹åŒ–Qdrant
â”‚   â”‚   â”œâ”€â”€ benchmark.py             # æ€§èƒ½åŸºå‡†
â”‚   â”‚   â”œâ”€â”€ acceptance_test.py       # éªŒæ”¶æµ‹è¯•
â”‚   â”‚   â””â”€â”€ testing/                 # æµ‹è¯•è„šæœ¬
â”‚   â”‚
â”œâ”€â”€ ğŸ“Š ç›‘æ§
â”‚   â”œâ”€â”€ monitoring/                  # ç›‘æ§é…ç½®
â”‚   â”‚   â”œâ”€â”€ README.md
â”‚   â”‚   â”œâ”€â”€ prometheus/              # Prometheusé…ç½®
â”‚   â”‚   â””â”€â”€ grafana/                 # Grafanaçœ‹æ¿
â”‚   â”‚
â”œâ”€â”€ ğŸ³ åŸºç¡€è®¾æ–½
â”‚   â”œâ”€â”€ docker-compose.yml           # Dockerç¼–æ’
â”‚   â”œâ”€â”€ Dockerfile                   # Dockeré•œåƒ
â”‚   â””â”€â”€ .dockerignore                # Dockerå¿½ç•¥
â”‚
â””â”€â”€ ğŸ”’ é…ç½®
    â”œâ”€â”€ .gitignore                   # Gitå¿½ç•¥
    â”œâ”€â”€ .env.example                 # ç¯å¢ƒå˜é‡æ¨¡æ¿
    â”œâ”€â”€ .pre-commit-config.yaml      # Pre-commité’©å­
    â””â”€â”€ requirements.txt             # Pythonä¾èµ–
```

---

## ğŸ“‹ æ–‡ä»¶åˆ†ç±»è¯´æ˜

### 1. æ ¹ç›®å½•æ–‡ä»¶ï¼ˆä¿æŒç²¾ç®€ï¼‰

| æ–‡ä»¶ | ç”¨é€” | å¿…è¦æ€§ |
|------|------|--------|
| README.md | é¡¹ç›®ä¸»æ–‡æ¡£ | âœ… å¿…éœ€ |
| CLAUDE.md | å¼€å‘æŒ‡å— | âœ… å¿…éœ€ |
| .gitignore | Gitå¿½ç•¥é…ç½® | âœ… å¿…éœ€ |
| .env.example | ç¯å¢ƒå˜é‡æ¨¡æ¿ | âœ… å¿…éœ€ |
| requirements.txt | Pythonä¾èµ– | âœ… å¿…éœ€ |
| docker-compose.yml | Dockerç¼–æ’ | âœ… å¿…éœ€ |

### 2. é…ç½®æ–‡ä»¶ï¼ˆåº”è¯¥åœ¨.gitignoreä¸­ï¼‰

| æ–‡ä»¶/ç›®å½• | è¯´æ˜ |
|----------|------|
| .env | ç¯å¢ƒå˜é‡ï¼ˆåŒ…å«å¯†é’¥ï¼‰|
| .venv/ | è™šæ‹Ÿç¯å¢ƒ |
| __pycache__/ | Pythonç¼“å­˜ |
| *.pyc | ç¼–è¯‘çš„Pythonæ–‡ä»¶ |
| .pytest_cache/ | Pytestç¼“å­˜ |
| htmlcov/ | æµ‹è¯•è¦†ç›–ç‡æŠ¥å‘Š |
| *.log | æ—¥å¿—æ–‡ä»¶ |

### 3. æµ‹è¯•æ–‡ä»¶åˆ†ç±»

| ä½ç½® | ç±»å‹ | ç¤ºä¾‹ |
|------|------|------|
| tests/test_inference/ | å•å…ƒæµ‹è¯• | æ¨¡å—åŠŸèƒ½æµ‹è¯• |
| tests/test_integration/ | é›†æˆæµ‹è¯• | è·¨æ¨¡å—æµ‹è¯• |
| tests/test_api/ | APIæµ‹è¯• | æ¥å£æµ‹è¯• |
| tests/performance/ | æ€§èƒ½æµ‹è¯• | å‹åŠ›æµ‹è¯•ã€åŸºå‡†æµ‹è¯• |
| frontend/test_*.html | å‰ç«¯æµ‹è¯• | åŠŸèƒ½æ¼”ç¤º |

### 4. æ–‡æ¡£åˆ†ç±»

| ä½ç½® | ç±»å‹ | ç¤ºä¾‹ |
|------|------|------|
| docs/ | æ´»è·ƒæ–‡æ¡£ | åŠŸèƒ½è¯´æ˜ã€ä½¿ç”¨æŒ‡å— |
| docs/archive/ | å†å²æ–‡æ¡£ | å¼€å‘è¿‡ç¨‹æ–‡æ¡£ |

---

## âœ… å½“å‰é¡¹ç›®ç»“æ„è¯„ä»·

### ä¼˜ç‚¹
1. âœ… **æ¨¡å—åŒ–æ¸…æ™°**: src/æŒ‰åŠŸèƒ½æ¨¡å—åˆ’åˆ†
2. âœ… **æµ‹è¯•å®Œå–„**: tests/åŒ…å«å„çº§æµ‹è¯•
3. âœ… **æ–‡æ¡£è§„èŒƒ**: docs/ç»“æ„æ¸…æ™°
4. âœ… **å‰ç«¯ç‹¬ç«‹**: frontend/è‡ªåŒ…å«
5. âœ… **è„šæœ¬é›†ä¸­**: scripts/ç»Ÿä¸€ç®¡ç†

### å¯é€‰ä¼˜åŒ–
1. âš ï¸ **frontendæµ‹è¯•é¡µé¢**: å¯è€ƒè™‘åˆ›å»ºfrontend/tests/å­ç›®å½•
2. âš ï¸ **scriptsåˆ†ç±»**: å¯æŒ‰åŠŸèƒ½åˆ†ç±»ï¼ˆsetup/testing/deploymentï¼‰

---

## ğŸ¯ æœ€ä½³å®è·µå»ºè®®

### 1. æ–‡ä»¶å‘½åè§„èŒƒ
- âœ… Pythonæ¨¡å—: `snake_case.py`
- âœ… æµ‹è¯•æ–‡ä»¶: `test_*.py`
- âœ… æ–‡æ¡£æ–‡ä»¶: `FEATURE_NAME.md`
- âœ… é…ç½®æ–‡ä»¶: `*.yaml`, `*.yml`, `*.json`

### 2. ç›®å½•ç»„ç»‡è§„èŒƒ
- âœ… æ¯ä¸ªæ¨¡å—æœ‰`__init__.py`
- âœ… æµ‹è¯•ä¸æºç å¯¹åº”ï¼ˆtests/test_xxxå¯¹åº”src/xxxï¼‰
- âœ… æ–‡æ¡£ä¸åŠŸèƒ½å¯¹åº”ï¼ˆdocs/xxx.mdå¯¹åº”åŠŸèƒ½ï¼‰

### 3. Gitç®¡ç†è§„èŒƒ
- âœ… .gitignoreåŒ…å«æ‰€æœ‰ä¸´æ—¶æ–‡ä»¶
- âœ… æ•æ„Ÿä¿¡æ¯åœ¨.envä¸­ï¼ˆä¸æäº¤ï¼‰
- âœ… æ–‡æ¡£å½’æ¡£åœ¨docs/archive/

---

## ğŸ“Š ç›®å½•ç»“æ„è¯„åˆ†

| ç»´åº¦ | è¯„åˆ† | è¯´æ˜ |
|------|------|------|
| **æ¨¡å—åŒ–** | â­â­â­â­â­ | æ¸…æ™°çš„æ¨¡å—åˆ’åˆ† |
| **å¯ç»´æŠ¤æ€§** | â­â­â­â­â­ | æ˜“äºå®šä½å’Œä¿®æ”¹ |
| **å¯æ‰©å±•æ€§** | â­â­â­â­â­ | æ–°åŠŸèƒ½æ˜“äºæ·»åŠ  |
| **æ–‡æ¡£å®Œæ•´æ€§** | â­â­â­â­â­ | æ–‡æ¡£é½å…¨ |
| **æµ‹è¯•è¦†ç›–** | â­â­â­â­â˜† | æµ‹è¯•å®Œå–„ï¼Œå¯å¢åŠ E2Eæµ‹è¯• |

**æ€»ä½“è¯„åˆ†**: â­â­â­â­â­ (5/5)

**ç»“è®º**: å½“å‰ç›®å½•ç»“æ„éå¸¸åˆç†ï¼Œå®Œå…¨æ»¡è¶³é¡¹ç›®ç®¡ç†éœ€æ±‚ï¼

---

**ç”Ÿæˆæ—¶é—´**: 2026-02-08
**ç‰ˆæœ¬**: v2.1
