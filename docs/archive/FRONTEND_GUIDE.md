# 前端界面测试指南

## 🎨 界面更新说明

前端界面已更新，新增了以下功能展示：

### 1. 新增意图识别字段展示

- **📈 趋势分析**: 显示识别到的趋势类型（上升/下降/波动/稳定）
- **🏆 排序需求**: 显示 Top N/Bottom N 排序需求
- **🎯 阈值过滤**: 显示数值比较和范围过滤条件

### 2. 会话历史功能

- 支持多轮对话上下文跟踪
- 显示历史查询的意图摘要
- 自动保存会话ID

### 3. 新增测试用例按钮

- 📈 趋势+排序: "GMV上升趋势前10名"
- 🎯 阈值过滤: "DAU大于10000的地区"
- 📊 波动分析: "最近30天GMV波动情况"
- 💬 指代查询: "它的增长率"（需要先查询GMV）

---

## 🧪 测试步骤

### 访问界面

打开浏览器访问: http://localhost:8080

### 测试1: 趋势分析意图识别

1. 点击 "📈 趋势+排序" 按钮
2. 点击 "🔍 检索"
3. **预期结果**:
   - 意图识别结果中显示 "📈 趋势分析: 上升趋势 ↗"（绿色）
   - 显示 "🏆 排序需求: Top 10 (降序)"（青色）

### 测试2: 阈值过滤意图识别

1. 点击 "🎯 阈值过滤" 按钮
2. 点击 "🔍 检索"
3. **预期结果**:
   - 意图识别结果中显示 "🎯 阈值过滤: DAU > 10000"（红色）
   - 返回符合条件的指标结果

### 测试3: 多轮对话指代解析

1. 在输入框输入 "GMV是多少"
2. 点击 "🔍 检索"
3. 等待结果返回后，在输入框输入 "它的增长率"
4. 再次点击 "🔍 检索"
5. **预期结果**:
   - 页面底部显示 "💬 会话历史" 区域
   - 显示两轮对话的摘要
   - 第二轮查询能够理解 "它" 指的是 "GMV"

### 测试4: 波动趋势分析

1. 点击 "📊 波动分析" 按钮
2. 点击 "🔍 检索"
3. **预期结果**:
   - 意图识别结果中显示 "📊 趋势分析: 波动趋势 〰"（黄色）

---

## 🔍 API 响应格式

### 趋势分析示例

```json
{
  "intent": {
    "core_query": "GMV上升趋势前10名",
    "trend_type": "upward",
    "sort_requirement": {
      "top_n": 10,
      "order": "desc",
      "metric": null
    }
  }
}
```

### 阈值过滤示例

```json
{
  "intent": {
    "core_query": "DAU大于10000",
    "threshold_filters": [
      {
        "metric": "DAU",
        "operator": ">",
        "value": 10000.0,
        "unit": null
      }
    ]
  }
}
```

### 会话上下文示例

```json
{
  "query": "它的增长率",
  "conversation_id": "bbaba068-2cd6-4661-9844-300177abf252",
  "intent": {
    "core_query": "它的增长率",
    "aggregation_type": "rate"
  }
}
```

---

## 📊 界面截图说明

### 意图识别卡片

位于结果区域顶部，以渐变紫色背景显示，包含：
- 🎯 意图识别结果 标题
- 核心查询、时间范围、聚合类型等原有字段
- **新增**: 趋势分析、排序需求、阈值过滤三个新字段

### 会话历史卡片

位于结果区域底部，以白色背景显示，包含：
- 💬 会话历史 标题
- 每轮对话的时间戳、查询内容、意图摘要
- 结果数量统计

---

## ✅ 功能检查清单

- [ ] 趋势分析正确识别（上升/下降/波动/稳定）
- [ ] 排序需求正确识别（Top N、降序/升序）
- [ ] 阈值过滤正确识别（运算符、数值、单位）
- [ ] 会话历史正确显示（时间戳、摘要）
- [ ] 多轮对话指代解析正常工作
- [ ] 测试用例按钮正常响应
- [ ] 界面样式和动画正常显示

---

## 🔧 常见问题

### Q1: 会话历史不显示？

**A**: 需要至少执行一次查询后，会话历史区域才会显示。确保没有使用浏览器的 "禁用 JavaScript" 功能。

### Q2: 指代查询不工作？

**A**: 指代查询需要先有一轮对话建立上下文。例如：
1. 第一轮: "GMV是多少"
2. 第二轮: "它的增长率"（此时 "它" 指代 "GMV"）

### Q3: 趋势/排序/阈值不显示？

**A**: 这些字段仅在查询中包含相关意图时显示。如果查询不包含这些意图，相应字段不会出现在意图识别结果中。

---

## 🚀 下一步优化建议

1. **添加 GLM 摘要展示**: 在结果卡片中显示指标的 GLM 生成的摘要
2. **可视化图表**: 使用 Chart.js 展示趋势曲线
3. **导出功能**: 支持导出查询结果为 CSV/JSON
4. **历史记录**: 本地存储查询历史，支持查看历史记录
5. **实时反馈**: 在检索过程中显示实时进度（召回→精排→验证）

---

**祝测试愉快！** 🎉
